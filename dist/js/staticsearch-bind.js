import{staticsearch as y}from"./__SSDIR__/staticsearch.js";var f="q",g=0,v=500;(()=>{let t=document.getElementById("staticsearch_search"),r=document.getElementById("staticsearch_result");r&&C(r,r.getAttribute("minscore"),r.getAttribute("maxresults")),t&&t.tagName==="INPUT"&&m(t)})();function S(){return new URLSearchParams(location.search).get(f)||""}function b(t,r){let n=new URL(location);t?n.searchParams.set(f,t):n.searchParams.delete(f),n.hash=r||"",history.replaceState({},"",n.href)}function m(t){t.name&&(f=t.name);let r=S();r&&(t.value=r);let n=t.value;n&&a(n);let p;t.addEventListener("input",c=>{let s=c.target.value;clearTimeout(p),p=setTimeout(()=>a(s),v)},!1);function a(c){c.length<2||y.find(c).then(s=>{})}}function C(t,r,n,p,a,c){let s="";r=parseFloat(r)||0,n=parseFloat(n)||0,a=a||document.getElementById("staticsearch_resultmessage"),a||(a=document.createElement("template"),a.innerHTML='<p part="resultmessage"><span part="resultcount">0</span> found for <span part="searchterm"></span>&hellip;</p>'),c=c||document.getElementById("staticsearch_item"),c||(c=document.createElement("template"),c.innerHTML='<li part="item"><a part="link"><h2 part="title"></h2><p part="description"></p></a></li>'),t.addEventListener("click",i=>{let l=i.target.closest("a");l&&s&&b(s,l.id)}),document.addEventListener("staticsearch:result",i=>{s=i.detail.search;let l=i.detail.result;t.innerHTML="";let o=document.createElement(p||"ol");o.setAttribute("part","searchresult"),l.forEach((e,E)=>{if(r&&e.relevancy<r||n&&E>=n)return;let u=c.content.cloneNode(!0);h(u,"link",null,{href:e.url,id:`staticsearchresult-${e.id}`}),h(u,"title",e.title),h(u,"description",e.description),o.appendChild(u)});let d=a.content.cloneNode(!0);if(h(d,"resultcount",o.childElementCount),h(d,"searchterm",s),t.appendChild(d),t.appendChild(o),!g&&location.hash){let e=t.querySelector(location.hash);e&&(e.focus(),e.scrollIntoView({behavior:"smooth",block:"nearest"}))}else t.scrollTop=0;g++},!1);function h(i,l,o,d={}){i.querySelectorAll(`[part="${l}"]`).forEach(e=>{for(let[E,u]of Object.entries(d))e.setAttribute(E,u);if(o){for(;e.firstElementChild;)e=e.firstElementChild;e.textContent=o}})}}export{m as staticSearchInput,S as staticSearchQuery,C as staticSearchResult,b as staticSearchSetQuery};
