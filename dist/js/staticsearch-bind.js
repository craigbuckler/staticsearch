import{staticsearch as g}from"./__SSDIR__/staticsearch.js";var f="q",m=500;(()=>{let t=document.getElementById("staticsearch_search"),e=document.getElementById("staticsearch_result");e&&t&&t.tagName==="INPUT"&&(C(e,e.getAttribute("minscore"),e.getAttribute("maxresults")),y(t))})();function v(){return new URLSearchParams(location.search).get(f)||""}function b(t,e){let r=new URL(location);t?r.searchParams.set(f,t):r.searchParams.delete(f),r.hash=e||"",history.replaceState({},"",r.href)}function y(t,e){t.name&&(f=t.name);let r=v();r&&(t.value=r);let p=t.value;p&&s(p);let a;t.addEventListener("input",c=>{let o=c.target.value;clearTimeout(a),a=setTimeout(()=>s(o),m)},!1);function s(c){c.length<3||g.find(c,e).then(o=>{document.dispatchEvent(new CustomEvent("staticsearch:find",{bubbles:!0,detail:{search:c,result:o}}))})}}function C(t,e,r,p,a,s){let c="";e=parseFloat(e)||0,r=parseFloat(r)||0,a=a||document.getElementById("staticsearch_resultmessage"),a||(a=document.createElement("template"),a.innerHTML='<p part="resultmessage"><span part="resultcount">0</span> found for <span part="searchterm"></span>&hellip;</p>'),s=s||document.getElementById("staticsearch_item"),s||(s=document.createElement("template"),s.innerHTML='<li part="item"><a part="link"><h2 part="title"></h2><p part="description"></p></a></li>'),t.addEventListener("click",l=>{let u=l.target.closest("a");u&&c&&b(c,u.id)}),document.addEventListener("staticsearch:find",l=>{c=l.detail.search;let u=l.detail.result;t.innerHTML="";let i=document.createElement(p||"ol");i.setAttribute("part","searchresult"),u.forEach((n,E)=>{if(e&&n.relevancy<e||r&&E>=r)return;let d=s.content.cloneNode(!0);o(d,"link",null,{href:n.url,id:`staticsearchresult-${n.id}`}),o(d,"title",n.title),o(d,"description",n.description),i.appendChild(d)});let h=a.content.cloneNode(!0);o(h,"resultcount",i.childElementCount),o(h,"searchterm",c),t.appendChild(h),t.appendChild(i),t.scrollTop=0},!1);function o(l,u,i,h={}){l.querySelectorAll(`[part="${u}"]`).forEach(n=>{for(let[E,d]of Object.entries(h))n.setAttribute(E,d);if(i){for(;n.firstElementChild;)n=n.firstElementChild;n.textContent=i}})}}export{y as staticSearchInput,v as staticSearchQuery,C as staticSearchResult,b as staticSearchSetQuery};
