import{staticsearch as m}from"./__SSDIR__/staticsearch.js";var f="q",S=0,y="__AGENT__",E=Symbol(y),b=500;(()=>{let t=document.getElementById("staticsearch_search"),r=document.getElementById("staticsearch_result");r&&L(r,r.getAttribute("minscore"),r.getAttribute("maxresults")),t&&t.tagName==="INPUT"&&C(t)})();function v(){return new URLSearchParams(location.search).get(f)||""}function I(t,r){let n=new URL(location);t?n.searchParams.set(f,t):n.searchParams.delete(f),n.hash=r||"",history.replaceState({},"",n.href)}function C(t){if(t[E])return;t[E]=!0,t.name&&(f=t.name);let r=v()||sessionStorage.getItem(y)||"";r&&(t.value=r);let n=t.value;n&&a(n);let p;t.addEventListener("input",s=>{let c=s.target.value;clearTimeout(p),p=setTimeout(()=>a(c),b)},!1);function a(s){sessionStorage.setItem(y,s),!(s.length<2)&&m.find(s).then(c=>{})}}function L(t,r,n,p,a,s){if(t[E])return;t[E]=!0;let c="";r=parseFloat(r)||0,n=parseFloat(n)||0,a=a||document.getElementById("staticsearch_resultmessage"),a||(a=document.createElement("template"),a.innerHTML='<p part="resultmessage"><span part="resultcount">0</span> found for <span part="searchterm"></span>&hellip;</p>'),s=s||document.getElementById("staticsearch_item"),s||(s=document.createElement("template"),s.innerHTML='<li part="item"><a part="link"><h2 part="title"></h2><p part="description"></p></a></li>'),t.addEventListener("click",i=>{let l=i.target.closest("a");l&&c&&I(c,l.id)}),document.addEventListener("staticsearch:result",i=>{c=i.detail.search;let l=i.detail.result;t.innerHTML="";let o=document.createElement(p||"ol");o.setAttribute("part","searchresult"),l.forEach((e,g)=>{if(r&&e.relevancy<r||n&&g>=n)return;let u=s.content.cloneNode(!0);h(u,"link",null,{href:e.url,id:`staticsearchresult-${e.id}`}),h(u,"title",e.title),h(u,"description",e.description),o.appendChild(u)});let d=a.content.cloneNode(!0);if(h(d,"resultcount",o.childElementCount),h(d,"searchterm",c),t.appendChild(d),t.appendChild(o),!S&&location.hash){let e=t.querySelector(location.hash);e&&(e.focus(),e.scrollIntoView({behavior:"smooth",block:"nearest"}))}else t.scrollTop=0;S++},!1);function h(i,l,o,d={}){i.querySelectorAll(`[part="${l}"]`).forEach(e=>{for(let[g,u]of Object.entries(d))e.setAttribute(g,u);if(o){for(;e.firstElementChild;)e=e.firstElementChild;e.textContent=o}})}}export{C as staticSearchInput,v as staticSearchQuery,L as staticSearchResult,I as staticSearchSetQuery};
